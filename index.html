<html>

<head>
    <meta charset="utf-8">
    <title>HK Budget</title>
</head>

<style>
    .axis path,
    .axis line {
        fill: none;
        stroke: black;
        shape-rendering: crispEdges;
    }
    
    .axis text {
        font-family: sans-serif;
        font-size: 13px;
    }
    
    .MyRect {
        fill: rgb(10, 89, 121);
    }
    
    .MyText {
        fill: white;
        text-anchor: middle;
    }
</style>

<style>
    body {
        background-color: rgba(204, 250, 235, 0.712);
        font-family: 'Times New Roman', Times, serif
    }
    
    svg {
        width: 700px;
        height: 400px;
    }
</style>

<body>
    <h1> HK Budget of 2018-2019 </h1>
    <h3> (1) Amount and Sources of the Revenue (Billion HKD) </h3>
    <h4>The highest income of the total revenue of 2018 was from profits tax, and the lowest income was from salaries tax. </h4>

    <svg>
            <text x=30 y=380 >Investment Income</text>
            <text x=130 y=360 >Land Premium</text>
            <text x=260 y=380 >Profits Tax</text>
            <text x=350 y=360 >Salaries Tax</text>
            <text x=450 y=380 >Stamp Duties</text>
            <text x=560 y=360 >Other Revenue</text>
          </svg>

    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script>
        //画布大小
        var width = 700;
        var height = 400;

        //在 body 里添加一个 SVG 画布	
        var svg = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        //画布周边的空白
        var padding = {
            left: 30,
            right: 30,
            top: 20,
            bottom: 20
        };

        //定义一个数组
        var dataset = [39.8, 121, 155.1, 54.8, 100, 133.8];

        //x轴的比例尺
        var xScale = d3.scale.ordinal()
            .domain(d3.range(dataset.length))
            .rangeRoundBands([0, width - padding.left - padding.right]);

        //y轴的比例尺
        var yScale = d3.scale.linear()
            .domain([0, d3.max(dataset)])
            .range([height - padding.top - padding.bottom, 0]);

        //定义x轴
        var xAxis = d3.svg.axis()
            .scale(xScale)
            .orient("bottom");

        //定义y轴
        var yAxis = d3.svg.axis()
            .scale(yScale)
            .orient("left");

        //矩形之间的空白
        var rectPadding = 20;

        //添加矩形元素
        var rects = svg.selectAll(".MyRect")
            .data(dataset)
            .enter()
            .append("rect")
            .attr("class", "MyRect")
            .attr("transform", "translate(" + padding.left + "," + padding.top + ")")
            .attr("x", function(d, i) {
                return xScale(i) + rectPadding / 2;
            })
            .attr("y", function(d) {
                return yScale(d);
            })
            .attr("width", xScale.rangeBand() - rectPadding)
            .attr("height", function(d) {
                return height - padding.top - padding.bottom - yScale(d);
            });

        //添加文字元素
        var texts = svg.selectAll(".MyText")
            .data(dataset)
            .enter()
            .append("text")
            .attr("class", "MyText")
            .attr("transform", "translate(" + padding.left + "," + padding.top + ")")
            .attr("x", function(d, i) {
                return xScale(i) + rectPadding / 2;
            })
            .attr("y", function(d) {
                return yScale(d);
            })
            .attr("dx", function() {
                return (xScale.rangeBand() - rectPadding) / 2;
            })
            .attr("dy", function(d) {
                return 20;
            })
            .text(function(d) {
                return d;
            });



        //添加x轴
        svg.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(" + padding.left + "," + (height - padding.bottom) + ")")
            .call(xAxis);

        //添加y轴
        svg.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(" + padding.left + "," + padding.top + ")")
            .call(yAxis);
    </script>



    <h3> (2) Budgetal Expenditure (Billion HKD) </h3>
    <script>
        var width = 400;
        var height = 600;
        var dataset = [113.7, 78, 92.2, 85.6, 26.7, 21.3, 53.3, 87.1];

        var svg = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        var pie = d3.layout.pie();

        var piedata = pie(dataset);

        var outerRadius = 150; //外半径
        var innerRadius = 100; //内半径，为0则中间没有空白

        var arc = d3.svg.arc() //弧生成器
            .innerRadius(innerRadius) //设置内半径
            .outerRadius(outerRadius); //设置外半径

        var color = d3.scale.category10();

        var arcs = svg.selectAll("g")
            .data(piedata)
            .enter()
            .append("g")
            .attr("transform", "translate(" + (width / 2) + "," + (width / 2) + ")");

        arcs.append("path")
            .attr("fill", function(d, i) {
                return color(i);
            })
            .attr("d", function(d) {
                return arc(d);
            });

        arcs.append("text")
            .attr("transform", function(d) {
                return "translate(" + arc.centroid(d) + ")";
            })
            .attr("text-anchor", "middle")
            .text(function(d) {
                return d.data;
            });

        console.log(dataset);
        console.log(piedata);
    </script>

</body>

</html>